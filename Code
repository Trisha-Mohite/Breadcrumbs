import React, { useState } from 'react';
import { Expense, ViewType } from './types';
import { useLocalStorage } from './hooks/useLocalStorage';
import Header from './components/Header';
import Navigation from './components/Navigation';
import Dashboard from './components/Dashboard';
import AddExpense from './components/AddExpense';
import ExpenseList from './components/ExpenseList';
import Statistics from './components/Statistics';
import Budget from './components/Budget';
import Footer from './components/Footer';

function App() {
  const [expenses, setExpenses] = useLocalStorage<Expense[]>('expenses', []);
  const [budget, setBudget] = useLocalStorage<number>('budget', 1000);
  const [view, setView] = useState<ViewType>('dashboard');

  const addExpense = (expenseData: Omit<Expense, 'id' | 'timestamp'>) => {
    const newExpense: Expense = {
      ...expenseData,
      id: Date.now(),
      timestamp: Date.now()
    };
    setExpenses([newExpense, ...expenses]);
    setView('list');
  };

  const deleteExpense = (id: number) => {
    setExpenses(expenses.filter(exp => exp.id !== id));
  };

  const renderCurrentView = () => {
    switch (view) {
      case 'dashboard':
        return <Dashboard expenses={expenses} budget={budget} />;
      case 'add':
        return <AddExpense onAddExpense={addExpense} />;
      case 'list':
        return <ExpenseList expenses={expenses} onDeleteExpense={deleteExpense} />;
      case 'stats':
        return <Statistics expenses={expenses} />;
      case 'budget':
        return <Budget expenses={expenses} budget={budget} onBudgetChange={setBudget} />;
      default:
        return <Dashboard expenses={expenses} budget={budget} />;
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50">
      {/* Background decoration */}
      <div className="fixed inset-0 overflow-hidden pointer-events-none">
        <div className="absolute top-20 left-10 w-72 h-72 bg-emerald-200/20 rounded-full blur-3xl"></div>
        <div className="absolute top-40 right-20 w-96 h-96 bg-amber-200/20 rounded-full blur-3xl"></div>
        <div className="absolute bottom-20 left-1/3 w-80 h-80 bg-blue-200/20 rounded-full blur-3xl"></div>
      </div>
      
      <div className="relative max-w-6xl mx-auto px-4 py-8">
        <Header />
        
        <Navigation 
          currentView={view} 
          onViewChange={setView} 
          expenseCount={expenses.length} 
        />
        
        <main className="mb-8">
          {renderCurrentView()}
        </main>
        
        <Footer expenses={expenses} budget={budget} />
      </div>
    </div>
  );
}

export default App;
